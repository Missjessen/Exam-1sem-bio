-- Opret database, hvis den ikke findes
-- Slet databasen, hvis den allerede findes
DROP DATABASE IF EXISTS `cjsfkt3sf_cruisenightscinema`;

-- Opret databasen, hvis den ikke findes
CREATE DATABASE IF NOT EXISTS `cjsfkt3sf_cruisenightscinema`;
USE `cjsfkt3sf_cruisenightscinema`;



CREATE TABLE IF NOT EXISTS `customers` (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    phone VARCHAR(20) NOT NULL
    
);

CREATE TABLE IF NOT EXISTS `employees` (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    phone VARCHAR(20) NOT NULL,
    role VARCHAR(100) NOT NULL,
    address VARCHAR(255) NOT NULL
   
);


-- Opret tabel for film
CREATE TABLE IF NOT EXISTS `movies` (
     id CHAR(36) PRIMARY KEY,       -- UUID
     slug VARCHAR(255) UNIQUE,      -- Slug
    `age_limit` INT NOT NULL,
    `title` VARCHAR(255) NOT NULL,
    `director` VARCHAR(255) NOT NULL,
    `release_year` YEAR NOT NULL,
    `runtime` INT NOT NULL,
    `description` TEXT,
    `poster` VARCHAR(255)
    
);


-- Opret tabel for parkeringspladser
CREATE TABLE IF NOT EXISTS `spots` (
    `spot_id` INT AUTO_INCREMENT PRIMARY KEY,
    `spot_number` INT NOT NULL UNIQUE,
    `status` ENUM('available', 'booked') DEFAULT 'available'
);

-- Opret tabel for visningstider
CREATE TABLE IF NOT EXISTS `showtimes` (
    `showtime_id` INT AUTO_INCREMENT PRIMARY KEY,
    `movie_id` CHAR(36) NOT NULL,
    `show_date` DATE NOT NULL,
    `show_time` TIME NOT NULL,
    FOREIGN KEY (`movie_id`) REFERENCES `movies`(`id`) ON DELETE CASCADE
);

-- Opret tabel for bookinger
CREATE TABLE IF NOT EXISTS `bookings` (
    `booking_id` INT AUTO_INCREMENT PRIMARY KEY,
    `movie_id` CHAR(36) NOT NULL,          -- Opdateret til CHAR(36) for at matche UUID-formatet
    `spot_id` INT NOT NULL,
    `customer_id` INT,
    `booking_date` DATETIME DEFAULT CURRENT_TIMESTAMP,
    `price` INT,
    FOREIGN KEY (`movie_id`) REFERENCES `movies`(`id`) ON DELETE CASCADE,   -- Refererer til `id` i `movies`
    FOREIGN KEY (`spot_id`) REFERENCES `spots`(`spot_id`)
);

CREATE TABLE IF NOT EXISTS `reviews` (
    `review_id` INT AUTO_INCREMENT PRIMARY KEY,
    `movie_id` CHAR(36) NOT NULL,      -- Refererer til UUID i `movies` tabellen
    `customer_id` INT NOT NULL,        -- Refererer til kunden, der har skrevet anmeldelsen
    `rating` INT NOT NULL CHECK (rating BETWEEN 1 AND 5), -- Rating fra 1 til 5
    `comment` TEXT,
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (`movie_id`) REFERENCES `movies`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`customer_id`) REFERENCES `customers`(`id`) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS `pages` (
    id INT AUTO_INCREMENT PRIMARY KEY,
    `pages` VARCHAR(50) UNIQUE NOT NULL,
    title VARCHAR(255) NOT NULL,
    content TEXT,
    css_file VARCHAR(255),
    template_file VARCHAR(255)
);
CREATE TABLE site_settings (
    setting_key VARCHAR(255) PRIMARY KEY,
    setting_value TEXT NOT NULL
);



-- Tilføj eksempeldata i `films`-tabellen
INSERT INTO `movies` (`id`, `slug`, `age_limit`, `title`, `director`, `release_year`, `runtime`, `description`, `poster`) VALUES
(UUID(), 'the-dark-knight-2008', 13, 'The Dark Knight', 'Christopher Nolan', 2008, 152, 'When the menace known as the Joker wreaks havoc on Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.', '/path/to/poster/the-dark-knight.jpg'),
(UUID(), 'inception-2010', 13, 'Inception', 'Christopher Nolan', 2010, 148, 'A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a CEO.', '/path/to/poster/inception.jpg'),
(UUID(), 'interstellar-2014', 10, 'Interstellar', 'Christopher Nolan', 2014, 169, 'A team of explorers travel through a wormhole in space in an attempt to ensure humanity’s survival.', '/path/to/poster/interstellar.jpg'),
(UUID(), 'parasite-2019', 15, 'Parasite', 'Bong Joon Ho', 2019, 132, 'Greed and class discrimination threaten the newly formed symbiotic relationship between the wealthy Park family and the destitute Kim clan.', '/path/to/poster/parasite.jpg'),
(UUID(), 'whiplash-2014', 16, 'Whiplash', 'Damien Chazelle', 2014, 106, 'A promising young drummer enrolls at a cut-throat music conservatory where his dreams of greatness are mentored by an instructor who will stop at nothing to realize a student’s potential.', '/path/to/poster/whiplash.jpg');



INSERT INTO employees (name, email, phone, role, address) VALUES
('Michael Scott', 'michael@dundermifflin.com', '5551234', 'Manager', '1725 Slough Avenue'),
('Dwight Schrute', 'dwight@dundermifflin.com', '5555678', 'Assistant to the Regional Manager', '168 Beet Lane'),
('Jim Halpert', 'jim@dundermifflin.com', '5552468', 'Sales Representative', '54 Maple Street'),
('Pam Beesly', 'pam@dundermifflin.com', '5551357', 'Receptionist', '12 Park Drive'),
('Stanley Hudson', 'stanley@dundermifflin.com', '5557890', 'Sales Representative', '98 Elm Street');

INSERT INTO `customers` (name, email, phone) VALUES
('John Doe', 'john@example.com', '12345678'),
('Jane Smith', 'jane@example.com', '87654321'),
('Alice Johnson', 'alice@example.com', '11223344'),
('Bob Brown', 'bob@example.com', '99887766'),
('Charlie Green', 'charlie@example.com', '33445566'),
('Diana White', 'diana@example.com', '55667788');

-- Tilføj eksempeldata i `spots`-tabellen
INSERT INTO `spots` (`spot_number`, `status`) VALUES 
(1, 'available'), (2, 'available'), (3, 'available'), (4, 'available'), (5, 'available'),
(6, 'available'), (7, 'available'), (8, 'available'), (9, 'available'), (10, 'available'),
(11, 'available'), (12, 'available'), (13, 'available'), (14, 'available'), (15, 'available'),
(16, 'available'), (17, 'available'), (18, 'available'), (19, 'available'), (20, 'available'),
(21, 'available'), (22, 'available'), (23, 'available'), (24, 'available'), (25, 'available'),
(26, 'available'), (27, 'available'), (28, 'available'), (29, 'available'), (30, 'available'),
(31, 'available'), (32, 'available'), (33, 'available'), (34, 'available'), (35, 'available'),
(36, 'available'), (37, 'available'), (38, 'available'), (39, 'available'), (40, 'available'),
(41, 'available'), (42, 'available'), (43, 'available'), (44, 'available'), (45, 'available'),
(46, 'available'), (47, 'available'), (48, 'available'), (49, 'available'), (50, 'available');

-- Tilføj eksempeldata i `showtimes`-tabellen
INSERT INTO `showtimes` (`movie_id`, `show_date`, `show_time`)
VALUES
((SELECT id FROM movies WHERE slug = 'the-dark-knight-2008'), '2023-12-01', '18:00:00'),
((SELECT id FROM movies WHERE slug = 'the-dark-knight-2008'), '2023-12-01', '20:30:00'),
((SELECT id FROM movies WHERE slug = 'inception-2010'), '2023-12-15', '18:00:00'),
((SELECT id FROM movies WHERE slug = 'inception-2010'), '2023-12-15', '20:30:00');


INSERT INTO site_settings (setting_key, setting_value) VALUES
('site_title', 'Drive-In Bio'),
('contact_email', 'kontakt@driveinbio.dk'),
('opening_hours', 'Mandag-Søndag: 18:00 - 23:00'),
('about_content', 'Drive-In Bio tilbyder en unik filmoplevelse i det fri. Kom og nyd en aften med de nyeste film fra komforten af din egen bil.');


INSERT INTO `pages` (pages, title, content, css_file, template_file) VALUES
('home', 'Hjem - Drive-In Bio', 'Velkommen til Drive-In Bio.', 'assets/css/homePage.css', 'app/view/user/homePage.php'),
('program', 'Program - Drive-In Bio', 'Film for alle.', 'assets/css/program.css', 'app/view/user/program.php'),
('movie', 'Film - Drive-In Bio', 'Her er vores filmoversigt.', 'assets/css/movie.css', 'app/view/user/movie.php'),
('spots', 'Pladser - Drive-In Bio', 'Find din parkering.', 'assets/css/spots.css', 'app/view/user/spots.php'),
('ticket', 'Køb din spot - Drive-In Bio', 'Køb plads til den næste forestilling.', 'assets/css/ticket.css', 'app/view/user/ticket.php'),
('about', 'Om Os - Drive-In Bio', 'Lær mere om vores Drive-In biograf.', 'assets/css/about.css', 'app/view/user/about.php'),
('admin_movie', 'Om Os - Drive-In Bio', 'Lær mere om vores Drive-In biograf.', 'assets/css/admin_movie.css', 'app/view/admin/admin_movie.php');


INSERT INTO `reviews` (`movie_id`, `customer_id`, `rating`, `comment`)
VALUES
('550e8400-e29b-41d4-a716-446655440000', 1, 5, 'An incredible movie with stunning performances!'),
('123e4567-e89b-12d3-a456-426614174000', 2, 4, 'Great concept and execution, though a bit confusing at times.'),
('550e8400-e29b-41d4-a716-446655441111', 3, 5, 'A breathtaking space adventure with profound themes.'),
('550e8400-e29b-41d4-a716-446655440000', 3, 4, 'Very intense and captivating from start to finish.');
